class AcGameMenu{constructor(t){this.root=t,this.$menu=$('\n            <div class="ac-game-menu">\n                <div class="ac-game-menu-field">\n                    <div class="ac-game-menu-field-item ac-game-menu-field-item-single_mode">单人模式</div>\n                    <div class="ac-game-menu-field-item ac-game-menu-field-item-multi_mode">多人模式</div>\n                    <div class="ac-game-menu-field-item ac-game-menu-field-item-settings">设置</div>\n                </div>\n            </div>\n        '),this.root.$ac_game.append(this.$menu),this.$single_mode=this.$menu.find(".ac-game-menu-field-item-single_mode"),this.$multi_mode=this.$menu.find(".ac-game-menu-field-item-multi_mode"),this.$settings=this.$menu.find(".ac-game-menu-field-item-settings"),this.start()}start(){this.add_listening_events(),this.hide()}add_listening_events(){let t=this;this.$single_mode.click((function(){t.hide(),t.root.playground.show("single mode")})),this.$multi_mode.click((function(){t.hide(),t.root.playground.show("multi mode")})),this.$settings.click((function(){console.log("click settings"),t.root.settings.logout_on_remote()}))}show(){this.$menu.show()}hide(){this.$menu.hide()}}let last_timestamp,AC_GAME_OBJECTS=[];class AcGameObject{constructor(){AC_GAME_OBJECTS.push(this),this.has_called_start=!1,this.timedelta=0,this.uuid=this.create_uuid()}create_uuid(){let t="";for(let i=0;i<8;i++){t+=parseInt(Math.floor(10*Math.random()))}return t}start(){}update(){}late_update(){}on_destroy(){}destroy(){this.on_destroy();for(let t=0;t<AC_GAME_OBJECTS.length;t++)if(AC_GAME_OBJECTS[t]===this){AC_GAME_OBJECTS.splice(t,1);break}}}let AC_GAME_ANIMATION=function(t){for(let i=0;i<AC_GAME_OBJECTS.length;i++){let s=AC_GAME_OBJECTS[i];s.has_called_start?(s.timedelta=t-last_timestamp,s.update()):(s.start(),s.has_called_start=!0)}for(let t=0;t<AC_GAME_OBJECTS.length;t++){AC_GAME_OBJECTS[t].late_update()}last_timestamp=t,requestAnimationFrame(AC_GAME_ANIMATION)};requestAnimationFrame(AC_GAME_ANIMATION);class ChatField{constructor(t){this.playground=t,this.$history=$('<div class="ac-game-chat-field-history">历史记录</div>'),this.$input=$('<input type="text" class="ac-game-chat-field-input">'),this.$history.hide(),this.$input.hide(),this.func_id=null,this.playground.$playground.append(this.$history),this.playground.$playground.append(this.$input),this.start()}start(){this.add_listening_events()}add_listening_events(){let t=this;this.$input.keydown((function(i){if(27===i.which)return t.hide_input(),!1;if(13===i.which){let i=t.playground.root.settings.username,s=t.$input.val();return s&&(t.$input.val(""),t.playground.multi_player_socket.send_message(i,s)),!1}}))}render_message(t){return $(`<div>${t}</div>`)}add_message(t,i){this.show_history();let s=`[${t}]${i}`;this.$history.append(this.render_message(s)),this.$history.scrollTop(this.$history[0].scrollHeight)}show_history(){let t=this;this.$history.fadeIn(),this.func_id&&clearTimeout(this.func_id),this.func_id=setTimeout((function(){t.$history.fadeOut(),t.func_id=null}),3e3)}show_input(){this.show_history(),this.$input.show(),this.$input.focus()}hide_input(){this.$input.hide(),this.playground.game_map.$canvas.focus()}}class GameMap extends AcGameObject{constructor(t){super(),this.playground=t,this.$canvas=$("<canvas tabindex=0></canvas>"),this.ctx=this.$canvas[0].getContext("2d"),this.ctx.canvas.width=this.playground.$playground.width(),this.ctx.canvas.height=this.playground.$playground.height(),this.playground.$playground.append(this.$canvas)}start(){this.add_listening_events(),this.render(),this.$canvas.focus()}add_listening_events(){this.$canvas.on("contextmenu",(function(){return!1}))}resize(){this.ctx.canvas.width=this.playground.width,this.ctx.canvas.height=this.playground.height,this.ctx.fillStyle="rgba(0, 0, 0, 1)",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}update(){this.render()}render(){this.ctx.fillStyle="rgba(0,0,0,0.2)",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}}class Particle extends AcGameObject{constructor(t,i,s,e,a,n,h,r,l){super(),this.playground=t,this.ctx=this.playground.game_map.ctx,this.x=i,this.y=s,this.dx=a,this.dy=n,this.move_length=l,this.radius=e,this.speed=r,this.color=h,this.friction=.9,this.eps=.01}start(){}update(){if(this.move_length<this.eps||this.speed<this.eps)return this.destroy(),!1;let t=Math.min(this.move_length,this.speed*this.timedelta/1e3);this.x+=this.dx*t,this.y+=this.dy*t,this.speed*=this.friction,this.move_length-=t,this.render()}render(){let t=this.playground.scale;this.ctx.beginPath(),this.ctx.arc(this.x*t,this.y*t,this.radius*t,0,2*Math.PI,!1),this.ctx.fillStyle=this.color,this.ctx.fill()}}class Player extends AcGameObject{constructor(t,i,s,e,a,n,h,r,l){super(),this.playground=t,this.ctx=this.playground.game_map.ctx,this.direction_x=0,this.direction_y=0,this.move_length=0,this.x=i,this.y=s,this.radius=e,this.speed=n,this.color=a,this.character=h,this.username=r,this.photo=l,this.eps=.01,this.damage_x=0,this.damage_y=0,this.damage_speed=0,this.friction=.9,this.spendtime=0,this.alive=!0,this.skill="","robot"!==this.character&&(this.img=new Image,this.img.src=this.photo),"me"===this.character&&(this.fireball_coldtime=3,"sgsg"===this.username&&(this.fireball_coldtime=.1),this.fireball_img=new Image,this.fireball_img.src="https://app907.acapp.acwing.com.cn/static/image/playground/fireball.png",this.blink_coldtime=5,this.blink_img=new Image,this.blink_img.src="https://app907.acapp.acwing.com.cn/static/image/playground/blink.png")}start(){if("me"===this.character)this.add_listening_events();else if("robot"===this.character){let t=Math.random()*this.playground.width/this.playground.scale,i=Math.random()*this.playground.height/this.playground.scale;this.move_to(t,i)}}update(){this.spendtime+=this.timedelta/1e3,this.fireball_coldtime-=this.timedelta/1e3,this.fireball_coldtime=Math.max(0,this.fireball_coldtime),this.blink_coldtime-=this.timedelta/1e3,this.blink_coldtime=Math.max(0,this.blink_coldtime),this.update_attack(),this.update_position(),this.render()}update_attack(){if(this.alive&&"robot"===this.character&&this.spendtime>3&&Math.random()<1/300){let t=!1;for(let i=0;i<this.playground.players.length;i++)if("robot"!==this.playground.players[i].character){this.shoot_fireball(this.playground.players[i].x,this.playground.players[i].y),t=!0;break}if(!t){let t=this.playground.players[Math.floor(Math.random()*this.playground.players.length)];this.shoot_fireball(t.x,t.y)}}}update_position(){if(this.damage_speed>this.eps)this.direction_x=this.direction_y=0,this.move_length=0,this.x+=this.damage_x*this.damage_speed*this.timedelta/1e3,this.y+=this.damage_y*this.damage_speed*this.timedelta/1e3,this.damage_speed*=this.friction;else if(this.move_length<this.eps){if(this.move_length=0,this.direction_x=this.direction_y=0,"robot"===this.character){let t=Math.random()*this.playground.width/this.playground.scale,i=Math.random()*this.playground.height/this.playground.scale;this.move_to(t,i)}}else{let t=Math.min(this.move_length,this.speed*this.timedelta/1e3);this.x+=t*this.direction_x,this.y+=t*this.direction_y,this.move_length-=t}}add_listening_events(){let t=this;this.playground.game_map.$canvas.mousedown((function(i){if("multi mode"===t.playground.mode&&t.playground.chat_field.hide_input(),t.alive)if(1===i.which){const s=t.ctx.canvas.getBoundingClientRect();let e=(i.clientX-s.left)/t.playground.scale,a=(i.clientY-s.top)/t.playground.scale;"multi mode"===t.playground.mode?t.playground.multi_player_socket.send_move_to(t.uuid,e,a):t.move_to(e,a)}else if(3===i.which&&"blink"===t.skill){const s=t.ctx.canvas.getBoundingClientRect();let e=(i.clientX-s.left)/t.playground.scale,a=(i.clientY-s.top)/t.playground.scale;"multi mode"===t.playground.mode?t.playground.multi_player_socket.send_blink(t.uuid,e,a):t.blink(e,a),t.skill="",t.blink_coldtime=5}})),this.playground.game_map.$canvas.keydown((function(i){if(13===i.which&&"multi mode"===t.playground.mode)return t.playground.chat_field.show_input(),!1;if(t.alive)if(81===i.which){if(t.fireball_coldtime<t.eps){const i=t.ctx.canvas.getBoundingClientRect();let s=t.playground.mouse_x,e=t.playground.mouse_y;s=(s-i.left)/t.playground.scale,e=(e-i.top)/t.playground.scale,"multi mode"===t.playground.mode?t.playground.multi_player_socket.send_shoot_fireball(t.uuid,s,e):t.shoot_fireball(s,e),t.fireball_coldtime=3,"sgsg"===t.username&&(t.fireball_coldtime=.1)}}else 70===i.which&&t.blink_coldtime<t.eps&&(t.skill="blink")}))}is_attacked(t,i){if("sgsg"===this.username)return!0;for(let t=0;t<20+10*Math.random();t++){let t=this.x,i=this.y,s=this.radius*Math.random()*.1,e=2*Math.PI*Math.random(),a=Math.cos(e),n=Math.sin(e),h=this.color,r=10*this.speed,l=this.radius*Math.random()*3;new Particle(this.playground,t,i,s,a,n,h,r,l)}if(this.radius-=i,this.speed*=.8,this.radius<this.eps)return this.alive=!1,this.destroy(),!1;this.damage_x=Math.cos(t),this.damage_y=Math.sin(t),this.damage_speed=100*i}get_distance(t,i,s,e){let a=t-s,n=i-e;return Math.sqrt(a*a+n*n)}move_to(t,i){this.move_length=this.get_distance(this.x,this.y,t,i);let s=Math.atan2(i-this.y,t-this.x);this.direction_x=Math.cos(s),this.direction_y=Math.sin(s)}shoot_fireball(t,i){let s=this.x,e=this.y,a=Math.atan2(i-this.y,t-this.x),n=Math.cos(a),h=Math.sin(a);new FireBall(this.playground,this,s,e,n,h,.01,"orange",.5,1,.01),this.move_length=0,this.direction_x=0,this.direction_y=0}blink(t,i){let s=Math.min(.8,this.get_distance(this.x,this.y,t,i)),e=Math.atan2(i-this.y,t-this.x),a=this.x+s*Math.cos(e),n=this.y+s*Math.sin(e);this.x=a,this.y=n,this.move_length=0}render_skill_coldtime(){let t=this.playground.scale,i=1.5,s=.9,e=.04;this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(i*t,s*t,e*t,0,2*Math.PI,!1),this.ctx.stroke(),this.ctx.clip(),this.ctx.drawImage(this.fireball_img,(i-e)*t,(s-e)*t,2*e*t,2*e*t),this.ctx.restore(),this.fireball_coldtime>this.eps&&(this.ctx.beginPath(),this.ctx.moveTo(i*t,s*t),this.ctx.arc(i*t,s*t,e*t,0-Math.PI/2,2*Math.PI*(1-this.fireball_coldtime/3)-Math.PI/2,!0),this.ctx.lineTo(i*t,s*t),this.ctx.fillStyle="rgba(0, 0, 255, 0.6)",this.ctx.fill()),i=1.62,s=.9,e=.04,this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(i*t,s*t,e*t,0,2*Math.PI,!1),this.ctx.stroke(),this.ctx.clip(),this.ctx.drawImage(this.blink_img,(i-e)*t,(s-e)*t,2*e*t,2*e*t),this.ctx.restore(),this.blink_coldtime>0&&(this.ctx.beginPath(),this.ctx.moveTo(i*t,s*t),this.ctx.arc(i*t,s*t,e*t,0-Math.PI/2,2*Math.PI*(1-this.blink_coldtime/5)-Math.PI/2,!0),this.ctx.lineTo(i*t,s*t),this.ctx.fillStyle="rgba(0, 0, 255, 0.6)",this.ctx.fill())}render(){let t=this.playground.scale;"robot"!==this.character?(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(this.x*t,this.y*t,this.radius*t,0,2*Math.PI,!1),this.ctx.stroke(),this.ctx.clip(),this.ctx.drawImage(this.img,(this.x-this.radius)*t,(this.y-this.radius)*t,2*this.radius*t,2*this.radius*t),this.ctx.restore()):(this.ctx.beginPath(),this.ctx.arc(this.x*t,this.y*t,this.radius*t,0,2*Math.PI,!1),this.ctx.fillStyle=this.color,this.ctx.fill()),"me"===this.character&&this.render_skill_coldtime()}on_destroy(){"me"===this.character&&"multi mode"===this.playground.mode&&this.playground.multi_player_socket.send_dead(this.uuid);for(let t=0;t<this.playground.players.length;t++)if(this.playground.players[t]===this){this.playground.players.splice(t,1);break}this.playground.score_board.state||("me"===this.character?this.playground.score_board.lose():1===this.playground.players.length&&this.playground.score_board.win())}}class ScoreBoard extends AcGameObject{constructor(t){super(),this.playground=t,this.ctx=this.playground.game_map.ctx,this.state=null,this.win_img=new Image,this.win_img.src="https://cdn.acwing.com/media/article/image/2021/12/17/1_8f58341a5e-win.png",this.lose_img=new Image,this.lose_img.src="https://cdn.acwing.com/media/article/image/2021/12/17/1_9254b5f95e-lose.png"}start(){}add_listening_events(){let t=this;this.playground.game_map.$canvas.on("click",(function(){t.playground.over(),t.playground.hide(),t.playground.root.menu.show()}))}win(){this.state="win";let t=this;setTimeout((function(){t.add_listening_events()}),1e3)}lose(){this.state="lose";let t=this;setTimeout((function(){t.add_listening_events()}),1e3)}late_update(){this.render()}render(){let t=this.playground.height/2;"win"===this.state?this.ctx.drawImage(this.win_img,this.playground.width/2-t/2,this.playground.height/2-t/2,t,t):"lose"===this.state&&this.ctx.drawImage(this.lose_img,this.playground.width/2-t/2,this.playground.height/2-t/2,t,t)}}class FireBall extends AcGameObject{constructor(t,i,s,e,a,n,h,r,l,o,d){super(),this.playground=t,this.player=i,this.ctx=this.playground.game_map.ctx,this.x=s,this.y=e,this.direction_x=a,this.direction_y=n,this.move_length=o,this.radius=h,this.speed=l,this.color=r,this.damage=d,this.eps=.01}start(){}update(){let t=this.playground.players;for(let i=0;i<t.length;i++)if(t[i]!==this.player&&this.is_collision(t[i]))return"multi mode"===this.playground.mode?"me"===this.player.character&&this.attack(t[i]):this.attack(t[i]),this.destroy(),!1;if(this.move_length<this.eps)return this.destroy(),!1;{let t=Math.min(this.move_length,this.speed*this.timedelta/1e3);this.x+=t*this.direction_x,this.y+=t*this.direction_y,this.move_length-=t}this.render()}attack(t){let i=Math.atan2(t.y-this.y,t.x-this.x);return"multi mode"===this.playground.mode?this.playground.multi_player_socket.send_is_attacked(t.uuid,i,this.damage):t.is_attacked(i,this.damage),this.destroy(),!1}get_distance(t,i,s,e){let a=t-s,n=i-e;return Math.sqrt(a*a+n*n)}is_collision(t){return this.get_distance(this.x,this.y,t.x,t.y)<this.radius+t.radius}render(){let t=this.playground.scale;this.ctx.beginPath(),this.ctx.arc(this.x*t,this.y*t,this.radius*t,0,2*Math.PI,!1),this.ctx.fillStyle=this.color,this.ctx.fill()}}class MultiPlayerSocket{constructor(t){this.playground=t,this.ws=new WebSocket("wss://app907.acapp.acwing.com.cn/wss/multiplayer/"),this.uuid=this.create_uuid(),this.start()}create_uuid(){let t="";for(let i=0;i<8;i++){t+=parseInt(Math.floor(10*Math.random()))}return t}start(){let t=this;this.ws.onmessage=function(i){let s=JSON.parse(i.data),e=s.event;"create_player"===e?t.receive_create_player(s.uuid,s.username,s.photo):"move_to"===e?t.receive_move_to(s.uuid,s.tx,s.ty):"shoot_fireball"===e?t.receive_shoot_fireball(s.uuid,s.tx,s.ty):"is_attacked"===e?t.receive_is_attacked(s.uuid,s.angle,s.damage):"blink"===e?t.receive_blink(s.uuid,s.tx,s.ty):"message"===e&&t.receive_message(s.username,s.text)}}send_create_player(t,i,s){this.ws.send(JSON.stringify({event:"create_player",uuid:t,username:i,photo:s}))}receive_create_player(t,i,s){let e;e=t===this.uuid?new Player(this.playground,this.playground.width/2/this.playground.scale,.5,.05,"white",.5,"me",i,s):new Player(this.playground,this.playground.width/2/this.playground.scale,.5,.05,"white",.5,"enemy",i,s),e.uuid=t,this.playground.players.push(e)}send_move_to(t,i,s){this.ws.send(JSON.stringify({event:"move_to",uuid:t,tx:i,ty:s}))}get_player(t){for(let i=0;i<this.playground.players.length;i++){let s=this.playground.players[i];if(s.uuid===t)return s}}receive_move_to(t,i,s){let e=this.get_player(t);e&&e.move_to(i,s)}send_shoot_fireball(t,i,s){this.ws.send(JSON.stringify({event:"shoot_fireball",uuid:t,tx:i,ty:s}))}receive_shoot_fireball(t,i,s){let e=this.get_player(t);e&&e.shoot_fireball(i,s)}send_is_attacked(t,i,s){this.ws.send(JSON.stringify({event:"is_attacked",uuid:t,angle:i,damage:s}))}receive_is_attacked(t,i,s){let e=this.get_player(t);e&&e.is_attacked(i,s)}send_blink(t,i,s){this.ws.send(JSON.stringify({event:"blink",uuid:t,tx:i,ty:s}))}receive_blink(t,i,s){let e=this.get_player(t);e&&e.blink(i,s)}send_dead(t){this.ws.send(JSON.stringify({event:"dead",uuid:t}))}send_message(t,i){this.ws.send(JSON.stringify({event:"message",username:t,text:i}))}receive_message(t,i){this.playground.chat_field.add_message(t,i)}}class AcGamePlayground{constructor(t){this.root=t,this.$playground=$('\n            <div class="ac-game-playground">\n            </div>\n        '),this.mouse_x=0,this.mouse_y=0,this.root.$ac_game.append(this.$playground),this.width=this.$playground.width(),this.height=this.$playground.height(),this.start()}get_random_color(){let t=["white","green","red","pink","cyan"];return t[Math.floor(Math.random()*t.length)]}start(){this.hide(),this.add_listening_events()}add_listening_events(){let t=this;$(window).resize((function(){t.resize()})),$(window).mousemove((function(i){t.mouse_x=i.clientX,t.mouse_y=i.clientY}))}resize(){this.width=this.$playground.width(),this.height=this.$playground.height();let t=Math.min(this.width/16,this.height/9);this.width=16*t,this.height=9*t,this.scale=this.height,this.game_map&&this.game_map.resize()}show(t){if(this.$playground.show(),this.mode=t,this.players=[],this.game_map=new GameMap(this),this.resize(),this.score_board=new ScoreBoard(this),"single mode"===t){this.players.push(new Player(this,this.width/2/this.scale,.5,.05,"white",.5,"me",this.root.settings.username,this.root.settings.photo));for(let t=0;t<10;t++)this.players.push(new Player(this,this.width/2/this.scale,.5,.05,this.get_random_color(),.3,"robot"))}else if("multi mode"===t){let t=this,i=this.root.settings.username,s=this.root.settings.photo;this.chat_field=new ChatField(this),this.multi_player_socket=new MultiPlayerSocket(this);let e=this.multi_player_socket.uuid;this.multi_player_socket.ws.onopen=function(){t.multi_player_socket.send_create_player(e,i,s)}}}over(){if("multi mode"===this.mode)for(let t=0;t<this.players.length;t++){"me"===this.players[t].character&&this.multi_player_socket.send_dead(this.uuid)}for(;AC_GAME_OBJECTS.length>0;)AC_GAME_OBJECTS[0].destroy();this.$playground.empty()}hide(){this.$playground.hide()}}class Settings{constructor(t){this.root=t,this.username="",this.photo="",this.$settings=$('\n<div class="ac-game-settings">\n    <div class="ac-game-settings-login">\n        <div class="ac-game-settings-title">\n            登录\n        </div>\n        <div class="ac-game-settings-username">\n            <div class="ac-game-settings-item">\n                <input type="text" placeholder="用户名">\n            </div>\n        </div>\n        <div class="ac-game-settings-password">\n            <div class="ac-game-settings-item">\n                <input type="password" placeholder="密码">\n            </div>\n        </div>\n        <div class="ac-game-settings-submit">\n            <div class="ac-game-settings-item">\n                <button>登录</button>\n            </div>\n        </div>\n        <div class="ac-game-settings-error-message">\n        </div>\n        <div class="ac-game-settings-option">\n            注册\n        </div>\n        <br>\n        <div class="ac-game-settings-acwing">\n            <img width="30" src="https://app907.acapp.acwing.com.cn/static/image/settings/acwing_logo.png">\n            <br>\n            <div>\n                AcWing一键登录\n            </div>\n        </div>\n    </div>\n    <div class="ac-game-settings-register">\n        <div class="ac-game-settings-title">\n            注册\n        </div>\n        <div class="ac-game-settings-username">\n            <div class="ac-game-settings-item">\n                <input type="text" placeholder="用户名">\n            </div>\n        </div>\n        <div class="ac-game-settings-password ac-game-settings-password-first">\n            <div class="ac-game-settings-item">\n                <input type="password" placeholder="密码">\n            </div>\n        </div>\n        <div class="ac-game-settings-password ac-game-settings-password-second">\n            <div class="ac-game-settings-item">\n                <input type="password" placeholder="确认密码">\n            </div>\n        </div>\n        <div class="ac-game-settings-submit">\n            <div class="ac-game-settings-item">\n                <button>注册</button>\n            </div>\n        </div>\n        <div class="ac-game-settings-error-message">\n        </div>\n        <div class="ac-game-settings-option">\n            登录\n        </div>\n        <br>\n        <div class="ac-game-settings-acwing">\n            <img width="30" src="https://app907.acapp.acwing.com.cn/static/image/settings/acwing_logo.png">\n            <br>\n            <div>\n                AcWing一键登录\n            </div>\n        </div>\n    </div>\n</div>\n'),this.$login=this.$settings.find(".ac-game-settings-login"),this.$login_username=this.$login.find(".ac-game-settings-username input"),this.$login_password=this.$login.find(".ac-game-settings-password input"),this.$login_submit=this.$login.find(".ac-game-settings-submit button"),this.$login_error_message=this.$login.find(".ac-game-settings-error-message"),this.$login_register=this.$login.find(".ac-game-settings-option"),this.$login.hide(),this.$register=this.$settings.find(".ac-game-settings-register"),this.$register_username=this.$register.find(".ac-game-settings-username input"),this.$register_password=this.$register.find(".ac-game-settings-password-first input"),this.$register_password_confirm=this.$register.find(".ac-game-settings-password-second input"),this.$register_submit=this.$register.find(".ac-game-settings-submit button"),this.$register_error_message=this.$register.find(".ac-game-settings-error-message"),this.$register_login=this.$register.find(".ac-game-settings-option"),this.$acwing_login=this.$settings.find(".ac-game-settings-acwing img"),this.$register.hide(),this.root.$ac_game.append(this.$settings),this.start()}start(){let t=this;this.getinfo(),this.add_listening_events(),this.$acwing_login.click((function(){t.acwing_login()}))}add_listening_events(){this.add_listening_events_login(),this.add_listening_events_register()}add_listening_events_login(){let t=this;this.$login_register.click((function(){t.register()})),this.$login_submit.click((function(){t.login_on_remote()}))}add_listening_events_register(){let t=this;this.$register_login.click((function(){t.login()})),this.$register_submit.click((function(){t.register_on_remote()}))}acwing_login(){$.ajax({url:"https://app907.acapp.acwing.com.cn/settings/acwing_authorize_login/obtain_authorization",type:"GET",success:function(t){"success"===t.result&&window.location.replace(t.apply_code_url)}})}login_on_remote(){let t=this,i=this.$login_username.val(),s=this.$login_password.val();this.$login_error_message.empty(),$.ajax({url:"https://app907.acapp.acwing.com.cn/settings/login_system/login/",type:"GET",data:{username:i,password:s},success:function(i){"success"===i.result?location.reload():t.$login_error_message.html(i.result)}})}register_on_remote(){let t=this,i=this.$register_username.val(),s=this.$register_password.val(),e=this.$register_password_confirm.val();this.$register_error_message.empty(),$.ajax({url:"https://app907.acapp.acwing.com.cn/settings/login_system/register/",type:"GET",data:{username:i,password:s,password_confirm:e},success:function(i){"success"===i.result?location.reload():t.$register_error_message.html(i.result)}})}logout_on_remote(){if("ACAPP"===this.platform)return!1;$.ajax({url:"https://app907.acapp.acwing.com.cn/settings/login_system/logout/",type:"GET",success:function(t){"success"===t.result&&location.reload()}})}register(){this.$login.hide(),this.$register.show()}login(){this.$register.hide(),this.$login.show()}getinfo(){let t=this;$.ajax({url:"https://app907.acapp.acwing.com.cn/settings/login_system/getinfo/",type:"GET",data:{},success:function(i){"success"===i.result?(t.username=i.username,t.photo=i.photo,t.hide(),t.root.menu.show()):t.login()}})}hide(){this.$settings.hide()}show(){this.$settings.show()}}export class AcGame{constructor(t){this.id=t,this.$ac_game=$("#"+this.id),this.settings=new Settings(this),this.menu=new AcGameMenu(this),this.playground=new AcGamePlayground(this)}}
